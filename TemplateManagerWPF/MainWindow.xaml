<Window x:Class="TemplateManagerWPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:TemplateManagerWPF"
        xmlns:vm="clr-namespace:TemplateManagerWPF.ViewModels"
        xmlns:converters="clr-namespace:TemplateManagerWPF.Converters"
        mc:Ignorable="d"
        Title="定型文管理システム" Height="600" Width="900">

    <Window.Resources>
        <converters:EmptySummaryConverter x:Key="EmptySummaryConverter"/>
    </Window.Resources>

    <Window.DataContext>
        <vm:MainViewModel />
    </Window.DataContext>
    
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 検索エリア -->
        <StackPanel Grid.Row="0" Margin="0,0,0,10">
            <!-- 検索キーワード -->
            <Grid Margin="0,0,0,5">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="80"/>
                    <ColumnDefinition Width="100"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="100"/>
                    <ColumnDefinition Width="100"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0"
                           Text="検索:"
                           VerticalAlignment="Center"
                           FontSize="14"/>

                <ComboBox Grid.Column="1"
                          ItemsSource="{Binding SearchTargets}"
                          SelectedItem="{Binding SearchTarget}"
                          FontSize="14"
                          Padding="5"
                          Margin="0,0,5,0"/>

                <TextBox Grid.Column="2"
                         Text="{Binding SearchKeyword, UpdateSourceTrigger=PropertyChanged}"
                         FontSize="14"
                         Padding="5"
                         Margin="0,0,5,0"/>

                <Button Grid.Column="3"
                        Command="{Binding SearchCommand}"
                        Content="検索"
                        FontSize="14"
                        Padding="5"
                        Margin="0,0,5,0"/>

                <Button Grid.Column="4"
                        Command="{Binding ShowAllCommand}"
                        Content="全件表示"
                        FontSize="14"
                        Padding="5"/>
            </Grid>
            
            <!-- セクション選択 -->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="80"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <TextBlock Grid.Column="0" 
                           Text="セクション:" 
                           VerticalAlignment="Center" 
                           FontSize="14"/>
                
                <ComboBox Grid.Column="1"
                          ItemsSource="{Binding Sections}"
                          SelectedItem="{Binding SelectedSection}"
                          FontSize="14"
                          Padding="5"/>
            </Grid>
        </StackPanel>
        
        <!-- メインエリア（左右分割） -->
        <Grid Grid.Row="1" Margin="0,0,0,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="3*"/>
            </Grid.ColumnDefinitions>

            <!-- 左側: 定型文リスト -->
            <Border Grid.Column="0"
                    BorderBrush="Gray"
                    BorderThickness="1"
                    Margin="0,0,5,0">
                <ListBox ItemsSource="{Binding Templates}"
                         SelectedItem="{Binding SelectedTemplate}"
                         FontSize="14">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <Grid Margin="5">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Row="0"
                                           Text="{Binding Title}"
                                           FontWeight="Bold"
                                           FontSize="14"/>
                                <TextBlock Grid.Row="1"
                                           Text="{Binding Summary, Converter={StaticResource EmptySummaryConverter}}"
                                           Foreground="Gray"
                                           FontSize="12"/>
                            </Grid>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </Border>

            <!-- 分割線（ドラッグ可能） -->
            <GridSplitter Grid.Column="1"
                          Width="5"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Stretch"
                          Background="LightGray"
                          Margin="5,0,5,0"/>

            <!-- 右側: 編集エリア -->
            <Grid Grid.Column="2">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <TextBlock Grid.Row="0"
                           Text="編集エリア（コピー前に自由に編集できます）"
                           FontWeight="Bold"
                           Margin="5"/>

                <Border Grid.Row="1"
                        BorderBrush="Gray"
                        BorderThickness="1"
                        Margin="5">
                    <TextBox Text="{Binding EditableBody, UpdateSourceTrigger=PropertyChanged}"
                             AcceptsReturn="True"
                             TextWrapping="Wrap"
                             VerticalScrollBarVisibility="Auto"
                             FontSize="14"
                             Padding="5"/>
                </Border>

                <Button Grid.Row="2"
                        Command="{Binding CopyToClipboardCommand}"
                        Content="クリップボードにコピー"
                        FontSize="14"
                        Padding="10"
                        Margin="5"/>
            </Grid>
        </Grid>
        
        <!-- 操作ボタン -->
        <StackPanel Grid.Row="2"
                    Orientation="Horizontal"
                    HorizontalAlignment="Center"
                    Margin="0,0,0,10">
            <Button Command="{Binding AddTemplateCommand}"
                    Content="新規登録"
                    Width="100"
                    Padding="10,5"
                    Margin="5"/>
            <Button Command="{Binding EditTemplateCommand}"
                    Content="定型文を編集して保存"
                    Width="150"
                    Padding="10,5"
                    Margin="5"/>
            <Button Command="{Binding DeleteTemplateCommand}"
                    Content="削除"
                    Width="100"
                    Padding="10,5"
                    Margin="5"/>
        </StackPanel>
        
        <!-- ステータスバー -->
        <Border Grid.Row="3" 
                Background="LightGray" 
                Padding="10,5">
            <TextBlock Text="{Binding StatusMessage}" 
                       FontSize="12"/>
        </Border>
    </Grid>
</Window>